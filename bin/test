#!/usr/bin/env sh

set -e

export RAILS_ENV=test

echo "::group::ğŸ—„ï¸ Ensure a test database exists.\n"
bin/rails db:setup
echo "::endgroup::\n"

echo "::group::ğŸ—‚ï¸ Ensure an up-to-date schema.\n"
bin/rails db:test:prepare
echo "::endgroup::\n"

echo "::group::ğŸ—ƒï¸ Load test DB with fixture data.\n"
bin/rails db:fixtures:load
echo "::endgroup::\n"

echo "::group::ğŸ—œï¸ Precompile Assets ğŸ–¼ï¸\n"
bin/rails assets:precompile
echo "::endgroup::\n"

echo "::group::ğŸ¿ Unit & Integration Tests ğŸ¿\n"
bin/rails test
echo "::endgroup::\n"

echo "::group::ğŸ”¥ System Tests ğŸ”¥\n"
bin/rails test:system
echo "::endgroup::\n"
